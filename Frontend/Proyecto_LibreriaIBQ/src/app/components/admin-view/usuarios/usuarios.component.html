<div class="div-gen-users">

    <div class="d-flex justify-content-around w-100">
        <form class="form">
            <label for="search">
                <input (input)="emitFilterFN()" [(ngModel)]="filterString" [ngModelOptions]="{standalone: true}"
                    class="input" type="text" required="" placeholder="Busqueda ..." id="search">

                <div class="fancy-bg"></div>
                <div class="search">
                    <svg viewBox="0 0 24 24" aria-hidden="true"
                        class="r-14j79pv r-4qtqp9 r-yyyyoo r-1xvli5t r-dnmrzs r-4wgw6l r-f727ji r-bnwqim r-1plcrui r-lrvibr">
                        <g>
                            <path
                                d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z">
                            </path>
                        </g>
                    </svg>
                </div>
                <button class="close-btn" (click)="filterString = ''; emitFilterFN()">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </button>
            </label>

        </form>
        <button (click)="addingNewUser()">Añadir Usuario</button>
    </div>

    <div class="div-users-">
        <h1>Usuarios</h1>
        <div class="user_div" style="cursor: default; background-color: transparent;">
            <img src="" alt="">
            <span>Username</span>
            <span>Nombre</span>
            <span>Id Personal</span>
            <span>Rol</span>
        </div>
        <div class="user_div" style="cursor: default; background-color: transparent; height: 1px;"></div>

        @if (this.users.length > 0) {
        @for (user of filteredUsers; track user.id_account; let index = $index) {
        <div class=" user_div" (click)="userSelected(index)">
            <img src="user.png" alt="USER">
            <span>{{ user.username }}</span>
            <span>{{ user.first_name + ' ' + user.last_name }}</span>
            <span>{{ user.id }}</span>
            <span [innerHTML]="user.is_admin ? 'Admin' : 'User'"></span>
        </div>
        }
        } @else {
        <div class="user_div" style="cursor: default; background-color: transparent; height: 1px;">
            <h1>No existen usuarios registrados</h1>
        </div>
        }

    </div>

    @if (showFormUser) {
    <div class="container body_login_register py-5">
        <section class="text-center mb-4">
            <h1 [innerHTML]="isAddingNewUser ? 'Añadir Usuario' : 'Editar Usuario'"></h1>
        </section>

        <section class="row justify-content-center">
            <div class="col-12 col-sm-10 col-md-8 col-lg-6">
                <form [formGroup]="this.formUser">

                    <div class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <input readonly type="text" class="form-control" formControlName="username"
                            placeholder="al346655">
                    </div>

                    <div class="mb-3">
                        <label for="passw" class="form-label">Contraseña</label>
                        <input [readonly]="isAddingNewUser" type="text" class="form-control" formControlName="passw"
                            placeholder="*******">
                    </div>

                    <div class="mb-3">
                        <label for="first_name" class="form-label">Nombre(s)</label>
                        <input type="text" class="form-control" formControlName="first_name" placeholder="Juan">
                    </div>

                    <div class="mb-3">
                        <label for="last_name" class="form-label">Apellido(s)</label>
                        <input type="text" class="form-control" formControlName="last_name" placeholder="Hernández">
                    </div>

                    <div class="mb-3">
                        <label for="id" class="form-label">Id Personal</label>
                        <input (input)="modifyValues()" type="number" class="form-control" formControlName="id"
                            placeholder="Ej. 102030">
                    </div>

                    <div class="mb-3">
                        <label class="form-label d-block">¿Es administrador?</label>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" formControlName="is_admin" [value]="true"
                                id="adminYes" (change)="modifyValues()">
                            <label class="form-check-label" for="adminYes">Sí</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" formControlName="is_admin" [value]="false"
                                id="adminNo" (change)="modifyValues()">
                            <label class="form-check-label" for="adminNo">No</label>
                        </div>
                    </div>

                    <div class="alerts">
                        @if (formUser.touched && formUser.invalid) {
                        <div>Rellenar campos.</div>
                        }

                    </div>

                    <div class="d-flex justify-content-center gap-3 w-100 mt-3" style="width: 100%;">
                        <button [disabled]="this.formUser.invalid"
                            (click)="isAddingNewUser ? addNewUser() : modifyUser()" type="submit"
                            [innerHTML]="isAddingNewUser ? 'Añadir Usuario' : 'Modificar Usuario'"></button>
                        <button [hidden]="isAddingNewUser" (click)="deleteUser()" type="submit">Eliminar
                            Usuario</button>
                        <button (click)="this.showFormUser = false" type="submit">Cancelar</button>
                    </div>

                </form>

            </div>
        </section>

        <div class="mt-3 text-center"></div>
    </div>

    }


</div>